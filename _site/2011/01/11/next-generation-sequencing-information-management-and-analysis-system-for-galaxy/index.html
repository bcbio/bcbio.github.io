<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Next generation sequencing information management and analysis system for Galaxy &#8211; Blue Collar Bioinformatics</title>

<meta name="keywords" content="infrastructure, galaxy, lims">

  

<!-- Twitter Cards -->
<meta name="twitter:title" content="Next generation sequencing information management and analysis system for Galaxy">

<meta name="twitter:site" content="@chapmanb">
<meta name="twitter:creator" content="@chapmanb">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://localhost:4000/images/">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Next generation sequencing information management and analysis system for Galaxy">

<meta property="og:url" content="http://localhost:4000/2011/01/11/next-generation-sequencing-information-management-and-analysis-system-for-galaxy/">
<meta property="og:site_name" content="Blue Collar Bioinformatics">





<link rel="canonical" href="http://localhost:4000/2011/01/11/next-generation-sequencing-information-management-and-analysis-system-for-galaxy/">
<link href="http://feeds2.feedburner.com/bcbio" type="application/atom+xml" rel="alternate" title="Blue Collar Bioinformatics Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="http://localhost:4000/assets/js/vendor/html5shiv.min.js"></script>
  <script src="http://localhost:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<!-- MathJax -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		        
		    
		    <li><a href="http://localhost:4000/" >About</a></li>
		  
		    
		        
		    
		    <li><a href="http://localhost:4000/articles/" >Recent</a></li>
		  
		    
		        
		    
		    <li><a href="http://localhost:4000/tags/" >Topics</a></li>
		  
		    
		        
		    
		    <li><a href="http://localhost:4000/search/" >Search</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
      <h1 class="site-title animated fadeIn"><a href="http://localhost:4000/">Blue Collar Bioinformatics</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Biological data analysis, validation and visualization</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="http://localhost:4000/tags/#infrastructure" title="Pages tagged infrastructure">infrastructure</a>&nbsp;&bull;&nbsp;<a href="http://localhost:4000/tags/#galaxy" title="Pages tagged galaxy">galaxy</a>&nbsp;&bull;&nbsp;<a href="http://localhost:4000/tags/#lims" title="Pages tagged lims">lims</a></span>
        
          <h1 class="entry-title">Next generation sequencing information management and analysis system for Galaxy</h1>
        
      </header>
      <footer class="entry-meta">
        
          
        
          <img src="http://localhost:4000/images/diego-work.jpg" class="bio-photo" alt="Brad Chapman bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Brad Chapman</span></span>
        <span class="entry-date date published"><time datetime="2011-01-11T10:05:56-05:00"><i class="fa fa-calendar-o"></i> January 11, 2011</time></span>
        
        <span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
        
        
      </footer>
      <div class="entry-content">
        <p>Next generation sequencing technologies like <a href="http://www.illumina.com/technology/sequencing_technology.ilmn">Illumina</a>, <a href="http://solid.appliedbiosystems.com/">SOLiD</a> and <a href="http://www.454.com/">454</a> have provided core facilities with the ability to produce large amounts of sequence data. Along with this increased output comes the challenge of managing requests and samples, tracking sequencing runs, and automating downstream analyses.</p>
<p>Our group at <a href="http://genetics.mgh.harvard.edu/bioinformatics/">Massachusetts General Hospital</a> approached these challenges by developing a sample submission and tracking interface on top of the web-based <a href="http://bitbucket.org/galaxy/galaxy-central/wiki/Home">Galaxy</a> data integration platform. It provides a front end for biologists to enter their sample details and monitor the status of a project. For lab technicians doing the sample preparation and sequencing work, the system tracks sample states via a set of progressive queues providing data entry points at each step of the process. On the back end, an automated analysis pipeline processes data as it arrives off the sequencer, uploading the results back into Galaxy.</p>
<p>This post will show videos of the interface in action, describe installation and extension of the system, and detail the implementation architecture.</p>
<div id="front-end-usage">
<h2>Front-end usage</h2>
<div id="researcher-sample-entry">
<h3>Researcher sample entry</h3>
<p>Biologists use a local Galaxy server as an entry point to submit samples for sequencing. This provides a familiar interface and central location for both entering sample information and retrieving and analyzing the sequencing data.</p>
<p>Practically, a user begins by browsing to the sample submission page. There they are presented with a wizard interface which guides them through entry of sample details. Multiplexed samples are supported through a drag and drop interface.</p>
<p>[youtube=http://www.youtube.com/watch?v=HGhNMeEAFV0]</p>
<p>When all samples are entered, the user submits them as a sequencing project. This includes billing information and a project name to facilitate communication between the researcher and the core group about submissions. Users are able to view their submissions grouped as projects and track the state of constructs. Since we support a number of services in addition to sequencing -- like library construction, quantitation and validation -- this is a valuable way for users to track and organize their requests.</p>
<p>[youtube=http://www.youtube.com/watch?v=DtQG9IzpoCU]</p>
</div>
<div id="sequencing-tracking-and-management">
<h3>Sequencing tracking and management</h3>
<p>Administrators and sequencing technicians have access to additional functionality to help manage the internal sample preparation and sequencing workflow. The main sample tracking interface centers around a set of queues; each queue represents a state that a sample can be in. Samples move through the queues as they are processed, with additional information being added to the sample at each step. For instance, a sample in the 'Pre-sequencing quantitation' queue moves to the 'Sequencing' queue once it has been fully quantitated, with that quantitation information entered by the sequencing technician during the transition.</p>
<p>Assigning samples to flow cells occurs using a drag and drop <a href="http://jqueryui.com/">jQueryUI</a> interface. The design is flexible to allow for placing samples across multiple lanes or multiplexing multiple barcoded samples into a single lane.</p>
<p>[youtube=http://www.youtube.com/watch?v=Sjt6y1lbzVI]</p>
</div>
<div id="viewing-sequencing-results">
<h3>Viewing sequencing results</h3>
<p>Running a sequencing machine requires careful monitoring of results and our interface provides several ways to view this data. Raw cluster and read counts are linked to a list of runs. For higher level analyses, interactive plots are available for viewing reads over time and pass rates compared to read density. These allow adjustment of experimental procedures to maximize useful reads based on current machine chemistry.</p>
<p>[youtube=http://www.youtube.com/watch?v=4xrtPXE7Oe8]</p>
</div>
</div>
<div id="analysis-pipeline">
<h2>Analysis pipeline</h2>
<p>Utilizing a front end that organizes requests allows sequencing results to be processed through a fully automated analysis pipeline on the back end. The pipeline detects runs coming off of a sequencer, transfers files to storage and analysis machines and manages a number of processing steps:</p>
<ul>
<li>Alignment with <a href="http://bowtie-bio.sourceforge.net/">bowtie</a> or <a href="http://bio-bwa.sourceforge.net/">bwa</a>.</li>
<li>Generation of alignment and read statistics with <a href="http://picard.sourceforge.net/">Picard</a>, the <a href="http://hannonlab.cshl.edu/fastx_toolkit/">fastx toolkit</a> and <a href="http://solexaqa.sourceforge.net/">SolexaQA</a>.</li>
<li>Preparation of a <a href="http://bcbio.files.wordpress.com/2011/01/example-summary.pdf">summary PDF</a> with detailed statistics about the run and alignment.</li>
</ul>
<p>In addition to the default analysis, a full SNP calling pipeline is included with:</p>
<ul>
<li><a href="http://www.broadinstitute.org/gsa/wiki/index.php/The_Genome_Analysis_Toolkit">GATK</a> <a href="http://www.broadinstitute.org/gsa/wiki/index.php/Base_quality_score_recalibration">recalibration</a> and <a href="http://www.broadinstitute.org/gsa/wiki/index.php/Local_realignment_around_indels">realignment</a></li>
<li>SNP identification with GATK's <a href="http://www.broadinstitute.org/gsa/wiki/index.php/Unified_genotyper">unified genotyper</a></li>
<li>Variant effect prediction with <a href="http://sourceforge.net/projects/snpeff/">snpEff</a>.</li>
</ul>
<p>Fastq reads, alignments files, summary PDFs and other associated files are uploaded back into into Galaxy Data Libraries organized by sample names. Users can download results for offline work, or import them directly into their Galaxy history for further analysis or display.</p>
<p><a href="http://bcbio.files.wordpress.com/2011/01/data_library_results.png"><img src="http://bcbio.files.wordpress.com/2011/01/data_library_results.png?h=300" alt="Uploaded analysis files in data library" /></a></p>
</div>
<div id="installing-and-extending">
<h2>Installing and extending</h2>
<p>The code base is maintained as a <a href="http://bitbucket.org/chapmanb/galaxy-central">Bitbucket repository</a> that tracks the main <a href="http://bitbucket.org/galaxy/galaxy-central/src">galaxy-central</a> distribution. It is updated from the main site regularly to maintain compatibility, with the future goal of integrating a generalized version into the main source tree. <a href="https://bitbucket.org/galaxy/galaxy-central/wiki/LIMS/nglims">Detailed installation instructions</a> are available for setting up the front-end client.</p>
<p>The analysis pipeline is written in Python and drives a number of open source programs; it is available as a <a href="https://github.com/chapmanb/bcbb/tree/master/nextgen">GitHub repository</a> with documentation and installation instructions.</p>
<p>We are using the current system in production and continue to develop and add features based on user feedback. We would like to generalize this for other research cores with additional instruments and services, and would be happy to hear from developers working on this type of system for their facilities.</p>
</div>
<div id="implementation-details">
<h2>Implementation details</h2>
<p>This work would not have been possible without the great open source toolkits and frameworks that it builds on. Galaxy provides not only an analysis framework, but also a ready to use database structure for managing samples and requests. The front end builds off existing <a href="http://main.g2.bx.psu.edu/u/rkchak/p/sts">Galaxy sample tracking</a> work, and requires only two new database storage tables.</p>
<p>The main change from the existing sample tracking framework is a generalization of the sample and request relationships. Requests can both contain samples, and be a part of samples so that a sequenced sample is organized as:</p>
<p><a href="http://bcbio.files.wordpress.com/2010/03/request_samples.png"><img src="http://bcbio.files.wordpress.com/2010/03/request_samples.png?h=300" alt="Request sample database architecture" /></a></p>
<p>By reusing and expanding the great work of the Galaxy team, we hope to eventually integrate useful parts of this work into the Galaxy codebase.</p>
</div>

        
          <div id="disqus_thread"></div><!-- /#disqus_thread -->
          
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'bcbio'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="http://localhost:4000/2010/10/13/cloudbiolinux-progress-on-bioinformatics-cloud-images-and-data/" class="btn" title="CloudBioLinux: progress on bioinformatics cloud images and data">Previous</a>
      
      
        <a href="http://localhost:4000/2011/04/10/parallel-upload-to-amazon-s3-with-python-boto-and-multiprocessing/" class="btn" title="Parallel upload to Amazon S3 with python, boto and multiprocessing">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<div class="social-icons">
	<a href="https://twitter.com/chapmanb" title="Brad Chapman on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	<a href="https://github.com/chapmanb" title="Brad Chapman on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	<a href="https://github.com/chapmanb" title="Brad Chapman on Bitbucket" target="_blank"><i class="fa fa-bitbucket-square fa-2x"></i></a>
	
	
	
	
	
	
  
	
	<a href="https://linkedin.com/pub/3/300/8ba" title="Brad Chapman on LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
  <a href="http://feeds2.feedburner.com/bcbio" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = 'http://localhost:4000';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>




</body>
</html>
